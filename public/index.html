<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>File Upload Portal</title><style>*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;padding:20px}.container{background:rgba(255,255,255,0.95);border-radius:20px;padding:40px;max-width:900px;margin:0 auto;box-shadow:0 20px 40px rgba(0,0,0,0.1);backdrop-filter:blur(10px)}h1{text-align:center;margin-bottom:10px;color:#333;font-size:2.5rem}h2{text-align:center;margin-bottom:30px;color:#666;font-size:1.2rem;font-weight:400}.form-group{margin-bottom:25px}label{display:block;margin-bottom:10px;font-weight:600;color:#555;font-size:16px}select,input{width:100%;padding:15px;border:2px solid #e1e5e9;border-radius:10px;font-size:16px;transition:all 0.3s}select:focus,input:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1)}.options{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;margin-top:15px}.option{border:2px solid #e1e5e9;border-radius:12px;padding:20px;cursor:pointer;text-align:center;background:#fff;transition:all 0.3s;user-select:none;font-size:14px;font-weight:500}.option:hover{border-color:#667eea;transform:translateY(-3px);box-shadow:0 8px 25px rgba(0,0,0,0.1)}.option.selected{border-color:#667eea;background:linear-gradient(135deg,#f0f4ff,#e8f0ff);color:#667eea;font-weight:600;box-shadow:0 8px 25px rgba(102,126,234,0.2)}.btn{padding:15px 30px;border:none;border-radius:10px;font-size:16px;font-weight:600;cursor:pointer;background:linear-gradient(45deg,#667eea,#764ba2);color:white;margin-top:25px;transition:all 0.3s;position:relative;overflow:hidden}.btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 30px rgba(102,126,234,0.4)}.btn:disabled{background:#ccc!important;cursor:not-allowed;transform:none}.btn-small{padding:8px 15px;border:none;border-radius:8px;font-size:12px;cursor:pointer;font-weight:bold;margin:0 5px;transition:all 0.2s}.btn-remove{background:#dc3545;color:white}.btn-remove:hover{background:#c82333}.btn-success{background:#28a745;color:white}.btn-success:hover{background:#218838}.btn-warning{background:#ffc107;color:#333}.btn-warning:hover{background:#e0a800}.btn-danger{background:#dc3545;color:white}.btn-danger:hover{background:#c82333}.upload-controls{display:flex;gap:15px;margin-top:20px}.upload-controls .btn{margin-top:0;flex:1}.hidden{display:none}.file-drop-zone{border:3px dashed #d1d5db;border-radius:12px;padding:40px;text-align:center;background:#f9fafb;transition:all 0.3s;cursor:pointer;margin-bottom:20px}.file-drop-zone.dragover{border-color:#667eea;background:#f0f4ff;transform:scale(1.02)}.file-drop-zone:hover{border-color:#667eea;background:#f0f4ff}.drop-text{font-size:18px;color:#6b7280;margin-bottom:10px}.drop-subtext{font-size:14px;color:#9ca3af}.file-input{opacity:0;position:absolute;pointer-events:none}.file-list{margin-top:20px}.file-item{display:flex;align-items:center;justify-content:space-between;padding:20px;background:#fff;border-radius:12px;margin:15px 0;box-shadow:0 4px 15px rgba(0,0,0,0.08);border:1px solid #f0f0f0;transition:all 0.3s}.file-item:hover{box-shadow:0 8px 25px rgba(0,0,0,0.12);transform:translateY(-2px)}.file-item.completed{background:linear-gradient(135deg,#d4edda,#c3e6cb);border-color:#c3e6cb}.file-item.failed{background:linear-gradient(135deg,#f8d7da,#f5c6cb);border-color:#f5c6cb}.file-item.uploading{background:linear-gradient(135deg,#cce5ff,#b3d9ff);border-color:#99ccff}.file-info{flex:1;margin-left:15px}.file-name{font-weight:600;margin-bottom:8px;color:#333;font-size:15px;word-break:break-word}.file-size{font-size:13px;color:#666;margin-bottom:5px}.file-speed{font-size:11px;color:#888}.file-error{font-size:11px;color:#dc3545;margin-top:5px}.file-progress-container{margin-top:12px}.file-progress{height:8px;background:#f0f0f0;border-radius:4px;overflow:hidden;position:relative}.progress-fill{height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:4px;transition:width 0.3s ease;width:0%;position:relative}.progress-fill.uploading{animation:pulse 2s infinite}.progress-fill::after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);animation:shimmer 2s infinite}.file-status{padding:8px 15px;border-radius:20px;font-size:12px;font-weight:bold;text-transform:uppercase;margin-right:15px}.status-pending{background:#e9ecef;color:#495057}.status-uploading{background:#cce5ff;color:#004085}.status-paused{background:#fff3cd;color:#856404}.status-completed{background:#d4edda;color:#155724}.status-failed{background:#f8d7da;color:#721c24}.overall-progress{margin:30px 0;padding:30px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:15px;display:none;border:1px solid #dee2e6}.progress-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.progress-title{font-weight:bold;font-size:20px;color:#333}.progress-stats-text{font-size:16px;color:#666}.progress-bar{height:12px;background:#e1e5e9;border-radius:6px;overflow:hidden;position:relative}.progress-bar-fill{height:100%;background:linear-gradient(90deg,#667eea,#764ba2);border-radius:6px;transition:width 0.5s ease;width:0%}.progress-details{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:20px;margin-top:20px}.progress-detail{text-align:center}.progress-detail-label{font-size:13px;color:#666;margin-bottom:5px}.progress-detail-value{font-weight:600;color:#333;font-size:16px}.message{padding:20px;border-radius:12px;margin-top:20px;text-align:center;display:none;font-weight:500;font-size:16px}.success{background:linear-gradient(135deg,#d4edda,#c3e6cb);color:#155724;border:1px solid #c3e6cb}.error{background:linear-gradient(135deg,#f8d7da,#f5c6cb);color:#721c24;border:1px solid #f5c6cb}.info{background:linear-gradient(135deg,#d1ecf1,#bee5eb);color:#0c5460;border:1px solid #bee5eb}.warning{background:linear-gradient(135deg,#fff3cd,#ffeaa7);color:#856404;border:1px solid #ffeaa7}@keyframes shimmer{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}@keyframes pulse{0%{opacity:1}50%{opacity:0.7}100%{opacity:1}}.upload-icon{font-size:48px;margin-bottom:15px}.folder-path{background:#f8f9fa;padding:15px;border-radius:8px;margin-bottom:20px;font-family:monospace;font-size:14px;color:#666;border:1px solid #e9ecef}.folder-path strong{color:#333}.upload-complete-actions{margin-top:20px;text-align:center}.file-validation{margin-top:10px;padding:10px;background:#fff3cd;border:1px solid #ffeaa7;border-radius:8px;display:none}.file-validation ul{margin:10px 0 0 20px}.file-validation li{margin:5px 0}@media(max-width:768px){.container{padding:20px;margin:10px}.options{grid-template-columns:1fr}.upload-controls{flex-direction:column}.progress-details{grid-template-columns:1fr 1fr}}</style></head><body><div class="container"><h1>üì§ File Upload Portal</h1><h2>Select destination and upload your files</h2><div class="form-group"><label>Model Name:</label><select id="modelName"><option value="">Loading models...</option></select></div><div class="form-group"><label>Platform:</label><div class="options"><div class="option" data-platform="of">üîû OF</div><div class="option" data-platform="clean">‚ú® Clean</div><div class="option" data-platform="dirty">üî• Dirty</div></div></div><div class="form-group"><label>Category:</label><div class="options" id="categoryOptions"></div></div><div class="form-group hidden" id="scriptTitleGroup"><label>Script Title:</label><input type="text" id="scriptTitle" placeholder="Enter script title..."></div><div class="folder-path hidden" id="folderPath"><strong>Upload Path:</strong> <span id="pathText"></span></div><div class="form-group"><label>Upload Files:</label><div class="file-drop-zone" id="dropZone"><div class="upload-icon">üìÅ</div><div class="drop-text">Drag & drop files here</div><div class="drop-subtext">or click to browse ‚Ä¢ Max 1GB per file</div><input type="file" id="fileInput" class="file-input" multiple></div><div class="file-validation" id="fileValidation"><strong>‚ö†Ô∏è File Issues:</strong><ul id="validationList"></ul></div><div class="file-list" id="fileList"></div></div><div class="overall-progress" id="overallProgress"><div class="progress-header"><div class="progress-title">Google Drive Upload Progress</div><div class="progress-stats-text" id="overallStats">0 of 0 files</div></div><div class="progress-bar"><div class="progress-bar-fill" id="overallProgressFill"></div></div><div class="progress-details"><div class="progress-detail"><div class="progress-detail-label">Status</div><div class="progress-detail-value" id="uploadStatus">Ready</div></div><div class="progress-detail"><div class="progress-detail-label">Current File</div><div class="progress-detail-value" id="currentFile">--</div></div><div class="progress-detail"><div class="progress-detail-label">Completed</div><div class="progress-detail-value" id="filesCompleted">0</div></div><div class="progress-detail"><div class="progress-detail-label">Speed</div><div class="progress-detail-value" id="uploadSpeed">--</div></div></div></div><div class="upload-controls"><button class="btn" id="uploadBtn" disabled>üöÄ Start Upload</button><button class="btn btn-warning hidden" id="pauseBtn">‚è∏Ô∏è Pause Upload</button><button class="btn btn-success hidden" id="resumeBtn">‚ñ∂Ô∏è Resume Upload</button><button class="btn btn-danger hidden" id="cancelBtn">‚ùå Cancel Upload</button></div><div class="upload-complete-actions hidden" id="uploadCompleteActions"><button class="btn btn-success" onclick="clearCompletedFiles()">‚ú® Clear Files & Upload More</button></div><div class="message success" id="successMessage"></div><div class="message error" id="errorMessage"></div><div class="message info" id="infoMessage"></div><div class="message warning" id="warningMessage"></div></div><script>const API_BASE='/api';const MAX_FILE_SIZE=1024*1024*1024;const ALLOWED_EXTENSIONS=['.jpg','.jpeg','.png','.gif','.bmp','.webp','.mp4','.mov','.avi','.mkv','.wmv','.flv','.webm','.mp3','.wav','.aac','.pdf','.doc','.docx','.txt','.zip','.rar'];let formData={modelName:'',platform:'',category:'',scriptTitle:''};let selectedFiles=[];let isUploading=false;let isPaused=false;let uploadStats={total:0,completed:0,failed:0,paused:0,startTime:0,currentFileIndex:0};let currentFolderId=null;let uploadController=null;const platformCategories={of:['Scripts','Stories','Feed Posts'],clean:['Feed Posts','Stories','Reels'],dirty:['Photos','Videos','Reddit Verifications']};document.addEventListener('DOMContentLoaded',loadModelsAndSetup);async function loadModelsAndSetup(){setupEventListeners();await loadModels()}async function loadModels(){try{showMessage('info','Loading available models...');const response=await fetch(`${API_BASE}/models`);const data=await response.json();const select=document.getElementById('modelName');select.innerHTML='<option value="">Choose model...</option>';if(data.success&&data.models){data.models.forEach(model=>{const option=document.createElement('option');option.value=model;option.textContent=model;select.appendChild(option)})}else{['Amira','Noya','Mia','Jasmine','Thalia','Halima'].forEach(model=>{const option=document.createElement('option');option.value=model;option.textContent=model;select.appendChild(option)})}hideMessage()}catch(error){console.error('Error loading models:',error);const select=document.getElementById('modelName');select.innerHTML='<option value="">Choose model...</option>';['Amira','Noya','Mia','Jasmine','Thalia','Halima'].forEach(model=>{const option=document.createElement('option');option.value=model;option.textContent=model;select.appendChild(option)});hideMessage()}}function setupEventListeners(){const dropZone=document.getElementById('dropZone');const fileInput=document.getElementById('fileInput');dropZone.addEventListener('click',()=>fileInput.click());dropZone.addEventListener('dragover',e=>{e.preventDefault();dropZone.classList.add('dragover')});dropZone.addEventListener('dragleave',()=>dropZone.classList.remove('dragover'));dropZone.addEventListener('drop',e=>{e.preventDefault();dropZone.classList.remove('dragover');handleFiles(e.dataTransfer.files)});fileInput.addEventListener('change',e=>handleFiles(e.target.files));document.getElementById('modelName').addEventListener('change',e=>{formData.modelName=e.target.value;updatePath();updateUploadBtn()});document.getElementById('uploadBtn').addEventListener('click',startUpload);document.getElementById('pauseBtn').addEventListener('click',pauseUpload);document.getElementById('resumeBtn').addEventListener('click',resumeUpload);document.getElementById('cancelBtn').addEventListener('click',cancelUpload);document.addEventListener('click',e=>{if(e.target.closest('.option[data-platform]')){const opt=e.target.closest('.option[data-platform]');document.querySelectorAll('[data-platform]').forEach(o=>o.classList.remove('selected'));opt.classList.add('selected');formData.platform=opt.dataset.platform;updateCategories();updatePath();updateUploadBtn()}if(e.target.closest('.option[data-category]')){const opt=e.target.closest('.option[data-category]');document.querySelectorAll('[data-category]').forEach(o=>o.classList.remove('selected'));opt.classList.add('selected');formData.category=opt.dataset.category;updateSubcategory();updatePath();updateUploadBtn()}});document.getElementById('scriptTitle').addEventListener('input',e=>{formData.scriptTitle=e.target.value;updatePath();updateUploadBtn()})}function updateCategories(){const div=document.getElementById('categoryOptions');div.innerHTML='';(platformCategories[formData.platform]||[]).forEach(cat=>{const d=document.createElement('div');d.className='option';d.dataset.category=cat;d.textContent=cat;div.appendChild(d)});formData.category='';updateSubcategory()}function updateSubcategory(){const script=document.getElementById('scriptTitleGroup');script.classList.add('hidden');if(formData.category==='Scripts'){script.classList.remove('hidden')}}function updatePath(){if(!formData.modelName||!formData.platform||!formData.category){document.getElementById('folderPath').classList.add('hidden');return}let path=`${formData.modelName}/`;path+=formData.platform==='of'?'OF/':formData.platform.charAt(0).toUpperCase()+formData.platform.slice(1)+'/';path+=formData.category+'/';if(formData.category==='Scripts'&&formData.scriptTitle){path+=formData.scriptTitle+'/'}if(formData.platform==='of'&&(formData.category==='Stories'||formData.category==='Feed Posts')){path+='Not Uploaded/'}document.getElementById('pathText').textContent=path;document.getElementById('folderPath').classList.remove('hidden')}function handleFiles(files){const newFiles=Array.from(files);const validationIssues=[];newFiles.forEach((file,index)=>{const ext='.'+file.name.split('.').pop().toLowerCase();if(!ALLOWED_EXTENSIONS.includes(ext)){validationIssues.push(`${file.name}: Unsupported file type`);return}if(file.size>MAX_FILE_SIZE){validationIssues.push(`${file.name}: File too large (max 1GB)`);return}if(selectedFiles.some(f=>f.name===file.name)){validationIssues.push(`${file.name}: Duplicate file name`);return}selectedFiles.push({id:Date.now()+index,file:file,name:file.name,size:file.size,status:'pending',progress:0,error:null})});if(validationIssues.length>0){showFileValidation(validationIssues)}else{hideFileValidation()}displayFiles();updateUploadBtn()}function showFileValidation(issues){const validation=document.getElementById('fileValidation');const list=document.getElementById('validationList');list.innerHTML='';issues.forEach(issue=>{const li=document.createElement('li');li.textContent=issue;list.appendChild(li)});validation.style.display='block'}function hideFileValidation(){document.getElementById('fileValidation').style.display='none'}function displayFiles(){const list=document.getElementById('fileList');list.innerHTML='';selectedFiles.forEach(fileObj=>{const item=document.createElement('div');item.className=`file-item ${fileObj.status}`;item.id=`file-${fileObj.id}`;item.innerHTML=`<div style="font-size:32px;">${getFileIcon(fileObj.file.type)}</div><div class="file-info"><div class="file-name">${fileObj.name}</div><div class="file-size">${formatFileSize(fileObj.size)}</div>${fileObj.error?`<div class="file-error">‚ùå ${fileObj.error}</div>`:''}<div class="file-progress-container ${fileObj.status==='uploading'||fileObj.status==='completed'?'':'hidden'}"><div class="file-progress"><div class="progress-fill ${fileObj.status==='uploading'?'uploading':''}"></div></div></div></div><div style="display:flex;align-items:center;flex-direction:column;gap:10px;"><span class="file-status status-${fileObj.status}">${getStatusText(fileObj.status)}</span><div><button class="btn-small btn-remove" onclick="removeFile('${fileObj.id}')" ${fileObj.status==='uploading'?'disabled':''}>Remove</button></div></div>`;list.appendChild(item)})}function removeFile(fileId){selectedFiles=selectedFiles.filter(f=>f.id!=fileId);const element=document.getElementById(`file-${fileId}`);if(element)element.remove();updateUploadBtn();hideFileValidation()}function updateUploadBtn(){const valid=formData.modelName&&formData.platform&&formData.category&&selectedFiles.length>0&&(formData.category!=='Scripts'||formData.scriptTitle);document.getElementById('uploadBtn').disabled=!valid||isUploading}function updateControlButtons(){document.getElementById('uploadBtn').classList.toggle('hidden',isUploading);document.getElementById('pauseBtn').classList.toggle('hidden',!isUploading||isPaused);document.getElementById('resumeBtn').classList.toggle('hidden',!isPaused);document.getElementById('cancelBtn').classList.toggle('hidden',!isUploading)}async function startUpload(){if(!selectedFiles.length)return;try{showMessage('info','Creating folder structure...');const folderResponse=await fetch(`${API_BASE}/create-folder-path`,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({modelName:formData.modelName,platform:formData.platform,category:formData.category,scriptTitle:formData.scriptTitle})});const folderResult=await folderResponse.json();if(!folderResult.success){throw new Error(folderResult.error||'Failed to create folder structure')}currentFolderId=folderResult.folderId;isUploading=true;isPaused=false;uploadController=new AbortController();updateUploadBtn();updateControlButtons();showOverallProgress();uploadStats={total:selectedFiles.length,completed:0,failed:0,paused:0,startTime:Date.now(),currentFileIndex:0};showMessage('info','Starting file uploads to Google Drive...');await uploadFilesSequentially()}catch(error){showMessage('error','Upload failed: '+error.message);resetUploadState()}}function pauseUpload(){isPaused=true;if(uploadController){uploadController.abort()}updateControlButtons();showMessage('warning','Upload paused. Click Resume to continue.')}function resumeUpload(){isPaused=false;uploadController=new AbortController();updateControlButtons();showMessage('info','Resuming upload...');uploadFilesSequentially()}function cancelUpload(){if(uploadController){uploadController.abort()}selectedFiles.forEach(file=>{if(file.status==='uploading'){file.status='pending';file.progress=0;updateFileDisplay(file)}});resetUploadState();showMessage('info','Upload cancelled.')}function resetUploadState(){isUploading=false;isPaused=false;uploadController=null;updateUploadBtn();updateControlButtons();document.getElementById('overallProgress').style.display='none'}async function uploadFilesSequentially(){const pendingFiles=selectedFiles.filter(f=>f.status==='pending');for(let i=0;i<pendingFiles.length;i++){if(isPaused||!isUploading)break;const fileObj=pendingFiles[i];uploadStats.currentFileIndex=i;updateOverallProgressDisplay();try{fileObj.status='uploading';updateFileDisplay(fileObj);showMessage('info',`Uploading to Google Drive: ${fileObj.name}`);document.getElementById('currentFile').textContent=fileObj.name;await uploadSingleFile(fileObj);if(!isPaused){fileObj.status='completed';fileObj.progress=100;uploadStats.completed++;updateFileDisplay(fileObj)}}catch(error){if(error.name!=='AbortError'){fileObj.status='failed';fileObj.error=error.message;uploadStats.failed++;updateFileDisplay(fileObj)}}updateOverallProgressDisplay()}if(!isPaused){resetUploadState();if(uploadStats.failed===0){showMessage('success',`üéâ All ${uploadStats.completed} files uploaded successfully to Google Drive!`);document.getElementById('uploadCompleteActions').classList.remove('hidden')}else{showMessage('warning',`Upload completed: ${uploadStats.completed} successful, ${uploadStats.failed} failed`)}}}async function uploadSingleFile(fileObj){const formDataObj=new FormData();formDataObj.append('folderId',currentFolderId);formDataObj.append('files',fileObj.file);const response=await fetch(`${API_BASE}/upload`,{method:'POST',body:formDataObj,signal:uploadController.signal});if(!response.ok){throw new Error(`Upload failed: ${response.status} ${response.statusText}`)}const result=await response.json();if(!result.success){throw new Error(result.error||'Upload failed')}}function updateFileDisplay(fileObj){const item=document.getElementById(`file-${fileObj.id}`);if(!item)return;item.className=`file-item ${fileObj.status}`;const status=item.querySelector('.file-status');const progressContainer=item.querySelector('.file-progress-container');const progress=item.querySelector('.progress-fill');const removeBtn=item.querySelector('.btn-remove');status.className=`file-status status-${fileObj.status}`;status.textContent=getStatusText(fileObj.status);removeBtn.disabled=fileObj.status==='uploading';if(fileObj.status==='uploading'){progressContainer.classList.remove('hidden');progress.style.width='100%';progress.classList.add('uploading')}else if(fileObj.status==='completed'){progressContainer.classList.remove('hidden');progress.style.width='100%';progress.classList.remove('uploading')}else{progressContainer.classList.add('hidden');progress.classList.remove('uploading')}}function getStatusText(status){const texts={pending:'Pending',uploading:'üì§ Uploading to Drive',paused:'‚è∏Ô∏è Paused',completed:'‚úÖ Done',failed:'‚ùå Failed'};return texts[status]||status}function showOverallProgress(){document.getElementById('overallProgress').style.display='block'}function updateOverallProgressDisplay(){const percentage=uploadStats.total>0?(uploadStats.completed/uploadStats.total)*100:0;document.getElementById('overallProgressFill').style.width=percentage+'%';document.getElementById('overallStats').textContent=`${uploadStats.completed} of ${uploadStats.total} files`;document.getElementById('uploadStatus').textContent=isPaused?'Paused':percentage===100?'Complete!':'Uploading to Google Drive...';document.getElementById('filesCompleted').textContent=uploadStats.completed;const elapsed=(Date.now()-uploadStats.startTime)/1000;const speed=uploadStats.completed/elapsed*60;document.getElementById('uploadSpeed').textContent=speed>0?`${speed.toFixed(1)} files/min`:'--'}function clearCompletedFiles(){selectedFiles=selectedFiles.filter(f=>f.status!=='completed');displayFiles();updateUploadBtn();document.getElementById('overallProgress').style.display='none';document.getElementById('uploadCompleteActions').classList.add('hidden');hideMessage();showMessage('info','‚ú® Ready for new uploads!')}function getFileIcon(type){if(type.startsWith('image/'))return'üñºÔ∏è';if(type.startsWith('video/'))return'üé•';if(type.startsWith('audio/'))return'üéµ';return'üìÑ'}function formatFileSize(bytes){if(!bytes)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB','TB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return parseFloat((bytes/Math.pow(k,i)).toFixed(2))+' '+sizes[i]}function showMessage(type,message){hideMessage();const msg=document.getElementById(type+'Message');if(msg){msg.textContent=message;msg.style.display='block'}}function hideMessage(){document.querySelectorAll('.message').forEach(m=>m.style.display='none')}</script></body></html>
